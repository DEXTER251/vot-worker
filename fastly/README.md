# Fastly Compute

> [!NOTE]
> Сайт fastly может быть недоступен в РФ, однако создаваемые приложения доступны

## Особенности

- Цена: бесплатно
- Запросы: неизвестно

## Деплой

1. Зарегистрируйтесь на [Fastly](https://fastly.com) и войдите в панель управления
2. В большом левом меню выберите пункт "Compute"
3. Нажмите на кнопку "Create service"
4. Выберите "Start something new"
5. Введите любое название в поле "Service name" и нажмите на кнопку "Next: Choose a starter kit"
6. Выберите вариант "Default starter for TypeScript" и нажмите на кнопку "Finalize and Deploy"
7. Дождитесь завершения загрузки и перейдите на страницу с созданным сервисом
8. Вверху выберите вкладку "Service configuration"
9. Далее нажмите на кнопку "Edit configuration", где следует выбрать "Clone version N (active) to edit"
10. После этого выберите вкладку "Package" и нажмите на кнопку "Upload new package"
11. Нажмите на "Browse the package" и выберите архив `pkg/vot-worker.tar.gz`
12. Нажмите на кнопку "Activate"
13. После перейдите на вкладку "Service summary" и нажмите на "Purge" - "Purge all" для очистки кеша
14. Готово, теперь, вы можете перейти по домену (есть на той же вкладке) и увидете, что все заработало

## Сборка

1. Установите NodeJS
2. Установите Fastly CLI
3. Установите зависимости

```bash
npm install
```
4. Соберите с помощью
```
npm run deploy
```

После сборки вам напишет, что у вас не установлен токен, но так и должно быть т.к. прямой деплой из РФ не доступен.

Если вы из другой страны и хотите сразу задеплоить, то вам необходимо прописать такую команду:

```
fastly compute publish --service-id=SERVICE_ID --token=API_TOKEN
```